// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
}

//Modelos

model User{
  userId    Int     @id @default(autoincrement())
  fullName  String 
  dni       Int     @unique
  wallets   Wallet[]

 @@map("users")
}

model Wallet{
  walletId    Int       @id @default(autoincrement())
  walletName  String   
  userId      Int
  walletType  walletType
  balance     User       @relation(fields:[userId],references: [userId], onDelete: Cascade)
  sentTransactions  Transaction[] @relation("SenderWallet")
  receivedTransactions Transaction[] @relation("ReceiverWallet")


  @@index([userId])
  @@map("wallets")
  }

  model Transaction {
    transactionId     Int @id @default(autoincrement())
    senderWalletId    Int?
    receiverWalletId  Int?
    amount            Float
    transactionType TransactionType
    isRejected       Boolean         @default(false)
    createdAt        DateTime        @default(now())
    senderWallet     Wallet?         @relation("SenderWallet", fields: [senderWalletId], references: [walletId], onDelete: NoAction)
    receiverWallet    Wallet? @relation("ReceiverWallet", fields:[receiverWalletId],references: [walletId], onDelete:NoAction)

  @@index([senderWalletId])
  @@index([receiverWalletId])
  @@index([createdAt])
  @@map("transactions")
  }

  //Enums

  enum walletType{
    bank_account
    cash
    transfer
  }
  enum TransactionType {
    income
    expense
  }